var Anterec;!function(e){var t=function(){function e(e,t){this.options=t,this.offsetX=5,this.offsetY=5,this.container=e,this.rebind(),$(this.container).addClass("jsdragtable")}return e.prototype.rebind=function(){var e=this;$(this.container).find("th").each(function(t,n){e.options.skipFirst&&0==t||($(n).off("mousedown touchstart"),$(n).off("mouseup touchend"),$(n).on("mousedown touchstart",function(t){return void 0==e.options.handleElementName||$(t.toElement).is(e.options.handleElementName)?void e.selectColumn($(n),t):void e.cancelColumn()}),$(n).on("mouseup touchend",function(t){return void 0==e.options.handleElementName||$(t.toElement).is(e.options.handleElementName)?void e.dropColumn($(n),t):void e.cancelColumn()}))}),$(this.container).on("mouseup touchend",function(){e.cancelColumn()})},e.prototype.selectColumn=function(e,t){var o=this;t.preventDefault();var i=new n(t);this.selectedHeader=e;var a=this.selectedHeader.index()+1,s=[];$(this.container).find("tr td:nth-child("+a+")").each(function(e,t){s[s.length]=t}),this.draggableContainer=$("<div/>"),this.draggableContainer.addClass("jsdragtable-contents"),this.draggableContainer.css({position:"absolute",left:i.event.pageX+this.offsetX,top:i.event.pageY+this.offsetY});var r=this.createDraggableTable(e);$(s).each(function(e,t){var n=$("<tr/>"),o=$("<td/>");$(o).html($(s[e]).html()),$(n).append(o),$(r).find("tbody").append(n)}),this.draggableContainer.append(r),$("body").append(this.draggableContainer),$(this.container).on("mousemove touchmove",function(t){o.moveColumn($(e),t)}),$(".jsdragtable-contents").on("mouseup touchend",function(){o.cancelColumn()})},e.prototype.moveColumn=function(e,t){if(t.preventDefault(),null!==this.selectedHeader){var o=new n(t);this.draggableContainer.css({left:o.event.pageX+this.offsetX,top:o.event.pageY+this.offsetY})}},e.prototype.dropColumn=function(e,t){var o=this;t.preventDefault();var i=this.selectedHeader.index()+1,a=$(t.target).index()+1,s=$(this.container).find("th").length,r=new n(t);if(r.isTouchEvent&&(e=$(document.elementFromPoint(r.event.clientX,r.event.clientY)),a=$(e).prevAll().length+1),!this.options.skipFirst||0!=a){if(i!==a){var l=[];$(this.container).find("tr td:nth-child("+i+")").each(function(e,t){l[l.length]=t,$(t).remove(),$(o.selectedHeader).remove()}),a>=s?(a=s-1,this.insertCells(l,a,function(e,t){$(e).after(t)})):this.insertCells(l,a,function(e,t){$(e).before(t)}),$(this.container).off("mousemove touchmove"),$(".jsdragtable-contents").remove(),this.draggableContainer=null,this.selectedHeader=null,this.rebind()}this.dropEvent()}},e.prototype.dropEvent=function(){void 0!=this.options.dropEvent&&this.options.dropEvent(this.container)},e.prototype.cancelColumn=function(){$(this.container).off("mousemove touchmove"),$(".jsdragtable-contents").remove(),this.draggableContainer=null,this.selectedHeader=null},e.prototype.createDraggableTable=function(e){var t=$("<table/>"),n=$("<thead/>"),o=$("<tbody/>"),i=$("<tr/>"),a=$("<th/>");return $(t).addClass($(this.container).attr("class")),$(t).width($(e).width()),$(a).html($(e).html()),$(i).append(a),$(n).append(i),$(t).append(n),$(t).append(o),t},e.prototype.insertCells=function(e,t,n){var o=this;$(this.container).find("tr td:nth-child("+t+")").each(function(t,o){n(o,$(e[t]))}),$(this.container).find("th:nth-child("+t+")").each(function(e,t){n(t,$(o.selectedHeader))})},e}();e.JsDragTable=t;var n=function(){function e(e){this.event=e,e.originalEvent&&e.originalEvent.touches&&e.originalEvent.changedTouches&&(this.event=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],this.isTouchEvent=!0)}return e}()}(Anterec||(Anterec={})),jQuery.fn.extend({jsdragtable:function(e){var t={skipFirst:!0};return e=$.extend(t,e),new Anterec.JsDragTable(this,e)}});